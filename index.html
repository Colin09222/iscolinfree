<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is Colin Free?</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0f0f0f; color: #ffffff; min-height: 100vh; padding: 40px 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { text-align: center; font-size: 2.5rem; margin-bottom: 40px; font-weight: 700; }
        .grid { display: grid; gap: 20px; }
        .card { background: #1a1a1a; border-radius: 16px; padding: 24px; border: 1px solid #2a2a2a; }
        .card-label { font-size: 0.85rem; color: #888; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
        .card-value { font-size: 1.5rem; font-weight: 600; }
        .heart-rate-card { background: linear-gradient(135deg, #1a1a1a 0%, #2d1f1f 100%); border-color: #3d2a2a; }
        .fort-card .card-value { color: #4ade80; }
        .fort-card .card-value.no { color: #f87171; }
        .pulsoid-widget { width: 100%; height: 100px; border: none; border-radius: 8px; }
        .dub-image { max-width: 100%; border-radius: 8px; margin-top: 10px; }
        .no-dub { color: #888; font-style: italic; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Is Colin Free?</h1>
        <div class="grid">
            <div class="card heart-rate-card">
                <div class="card-label">❤️ Heart Rate</div>
                <iframe src="https://pulsoid.net/widget/view/903a03b6-af65-4b8f-b011-cda39220c5ac" class="pulsoid-widget"></iframe>
            </div>
            <div class="card">
                <div class="card-label">Daily Status</div>
                <div class="card-value" id="daily-status">Loading...</div>
            </div>
            <div class="card">
                <div class="card-label">Currently Doing</div>
                <div class="card-value" id="currently-doing">Loading...</div>
            </div>
            <div class="card">
                <div class="card-label">Hours Slept</div>
                <div class="card-value" id="hours-slept">Loading...</div>
            </div>
            <div class="card">
                <div class="card-label">Last Workout</div>
                <div class="card-value" id="last-workout">Loading...</div>
            </div>
            <div class="card fort-card">
                <div class="card-label">Can Colin Fort?</div>
                <div class="card-value" id="can-fort">Loading...</div>
            </div>
            <div class="card">
                <div class="card-label">Last Fortnite Dub</div>
                <div id="fortnite-dub">Loading...</div>
            </div>
        </div>
    </div>
    <script>
        async function fetchStatus() {
            try {
                const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vSj0ZT3c560TunALL_hmI1kEo0nDrikhz9ayKDuvJyhGF9_iZATLlQPrqfZqrv80Jc0Iw1Nr6Zo2ohB/pub?output=csv');
                const csv = await response.text();
                const lines = csv.split('\n');
                if (lines.length >= 2) {
                    const values = lines[1].split(',');
                    document.getElementById('currently-doing').textContent = values[0] || 'Unknown';
                    document.getElementById('hours-slept').textContent = values[1] || 'Unknown';
                    document.getElementById('last-workout').textContent = values[2] || 'Unknown';
                    
                    const canFort = values[3] || 'Unknown';
                    const fortElement = document.getElementById('can-fort');
                    fortElement.textContent = canFort;
                    if (canFort.toLowerCase().includes('no')) { fortElement.classList.add('no'); }
                    
                    document.getElementById('daily-status').textContent = values[4] || 'Unknown';
                    
                    const dubUrl = values[5] ? values[5].trim() : '';
                    const dubElement = document.getElementById('fortnite-dub');
                    if (dubUrl && dubUrl.startsWith('http')) {
                        dubElement.innerHTML = '<img src="' + dubUrl + '" class="dub-image" alt="Last Fortnite Dub">';
                    } else {
                        dubElement.innerHTML = '<span class="no-dub">' + (dubUrl || 'No dub yet') + '</span>';
                    }
                }
            } catch (error) { console.error('Error:', error); }
        }
        fetchStatus();
        setInterval(fetchStatus, 300000);
    </script>
</body>
</html>
